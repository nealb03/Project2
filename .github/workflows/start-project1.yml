$wf = @"
name: Start EC2 + Start Backend (MyWebApi)

on:
  workflow_dispatch:
    inputs:
      aws_region:
        description: "AWS region where the instance exists"
        required: true
        default: "us-east-1"
      port:
        description: "Backend port"
        required: true
        default: "5001"

permissions:
  id-token: write
  contents: read

jobs:
  start:
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS credentials via OIDC (QA)
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-region: `${{ inputs.aws_region }}
          role-to-assume: arn:aws:iam::288761763536:role/GithubActionsRole

      - name: Start EC2 instance
        shell: bash
        run: |
          set -euo pipefail
          aws ec2 start-instances --instance-ids "i-0aa128f11e1299832" --output table
          aws ec2 wait instance-running --instance-ids "i-0aa128f11e1299832"
"@

New-Item -ItemType Directory -Force -Path ".github\workflows" | Out-Null

# Write UTF8 *without BOM*
$utf8NoBom = New-Object System.Text.UTF8Encoding($false)
[System.IO.File]::WriteAllText((Join-Path (Get-Location) ".github\workflows\start-project1.yml"), $wf, $utf8NoBom)

Write-Host "Rewrote .github/workflows/start-project1.yml as UTF8 (no BOM)."